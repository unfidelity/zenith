//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "C:\Users\Aestheticall\Documents\decomp\1.12 stable mappings"!

/*
 * Decompiled with CFR 0.152.
 */
package me.gopro336.zenith.feature.toggleable.exploit;

import me.gopro336.zenith.api.util.InventoryUtils;
import me.gopro336.zenith.event.network.PacketSendEvent;
import me.gopro336.zenith.feature.AnnotationHelper;
import me.gopro336.zenith.feature.Category;
import me.gopro336.zenith.feature.Feature;
import net.minecraft.init.Items;
import net.minecraft.item.Item;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import net.minecraft.network.play.client.CPacketPlayerTryUseItem;
import net.minecraft.util.EnumHand;
import net.minecraft.util.math.BlockPos;
import team.stiff.pomelo.impl.annotated.handler.annotation.Listener;

@AnnotationHelper(name="OppSmoker", description="puts opps in backwoods", category=Category.EXPLOIT)
public class OppSmoker
extends Feature {
    public static OppSmoker INSTANCE;

    public OppSmoker() {
        INSTANCE = this;
    }

    @Override
    public void onUpdate() {
        if (InventoryUtils.isHolding((Item)Items.BOW) && OppSmoker.mc.player.isHandActive() && OppSmoker.mc.player.getItemInUseMaxCount() >= 3) {
            OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayerDigging(CPacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, OppSmoker.mc.player.getHorizontalFacing()));
            OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayer.PositionRotation(OppSmoker.mc.player.posX, OppSmoker.mc.player.posY - 0.1, OppSmoker.mc.player.posZ, OppSmoker.mc.player.rotationYaw, OppSmoker.mc.player.rotationPitch, false));
            OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayer.PositionRotation(OppSmoker.mc.player.posX, OppSmoker.mc.player.posY - 1000.0, OppSmoker.mc.player.posZ, OppSmoker.mc.player.rotationYaw, OppSmoker.mc.player.rotationPitch, true));
            OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayerTryUseItem(EnumHand.MAIN_HAND));
            OppSmoker.mc.player.stopActiveHand();
        }
    }

    @Listener
    public void onPacketSend(PacketSendEvent event) {
        if (event.getPacket() instanceof CPacketPlayerDigging && ((CPacketPlayerDigging)event.getPacket()).getAction().equals((Object)CPacketPlayerDigging.Action.RELEASE_USE_ITEM) && InventoryUtils.isHolding((Item)Items.BOW) && OppSmoker.mc.player.getItemInUseMaxCount() >= 20) {
            for (int ticks = 0; ticks < 10; ++ticks) {
                double sin = -Math.sin(Math.toRadians(OppSmoker.mc.player.rotationYaw));
                double cos = Math.cos(Math.toRadians(OppSmoker.mc.player.rotationYaw));
                OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayer.Position(OppSmoker.mc.player.posX, OppSmoker.mc.player.posY - 0.1, OppSmoker.mc.player.posZ, false));
                OppSmoker.mc.player.connection.sendPacket((Packet)new CPacketPlayer.Position(OppSmoker.mc.player.posX + sin * 100.0, OppSmoker.mc.player.posY, OppSmoker.mc.player.posZ + cos * 100.0, true));
            }
        }
    }
}

